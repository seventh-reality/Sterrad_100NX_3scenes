<!doctype html>
<html lang="en" dir="ltr">

<head>
    <title>STERRADâ„¢ 100NX System</title>
    <meta charset="utf-8">
    <meta name="description" content="&lt;model-viewer&gt; template">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link type="text/css" href="./styles.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/focus-visible@5.0.2/dist/focus-visible.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://threejs.org/examples/js/libs/stats.min.js"></script>
    <script src="https://threejs.org/build/three.min.js"></script>
</head>

<body>
    <div id="card">
        <audio id="audio">
            <source id="audio-source" src="Intro.mp3" type="audio/mpeg">
        </audio>

        <model-viewer id="toggle-model" src="Steerad.glb"
            ios-banner="https://example.com/customBanners/comingSoonBanner.html" ar
            ar-modes="webxr scene-viewer quick-look" camera-controls alt="" shadow-intensity=".25" touch-action="pan-y" environment-image="legacy" animation-loop="false">
            <div class=" progress-bar hide" slot="progress-bar">
            <div class="update-bar"></div>
    </div>
        <button slot="ar-button" id="ar-button">
            View in 4D
        </button>
         
    <div id="button" style="display:flex; justify-content: space-between; transform: translate(0px,0px);">
        <img src="4.png" align="center" style="width:100px; padding-left: 5px;padding-top: 0px;" />
        <img src="Cam.png" style="width:120px; padding-right: 5px;padding-top: 0px;" />
    </div>
    <div id="all">          
    <button class="slide selected" id="1" onclick="switchSrc(1,'USAGE.glb','Intro.mp3')"
       style="transform:translateX(30px);" ><img src="Icon_2.png" style="width:40px;height:40px;"></button>
    <button class="slide selected" id="2" onclick="switchSrc(2,'Sterrad_PARTS.glb','parts.mp3')"
        ><img src="Icon_1.png" style="width:40px;height:40px;"></button>
    <button class="slide selected" id="3" onclick="switchSrc(3,'Steerad.glb','Usage.mp3')"
        style="transform:translateX(-30px);"><img src="Icon.png" style="width:40px;height:40px;"></button>
     </div>
    <div id="ar-prompt">
        <img src="ar_hand_prompt.png">
    </div>

    </model-viewer>

    <script>
        const models = ['Steerad.glb', 'Steeradtext.glb', 'sterrad_anim.glb'];
        const toggleModel = document.querySelector('#toggle-model');

        function handleButtonDisplay(indx) {
            document.getElementById("1").style.display = 'inline';
            document.getElementById("2").style.display = 'inline';
            document.getElementById("3").style.display = 'inline';

            switch (indx) {
                case 2:
                    document.getElementById("11").style.display = 'inline';
                    document.getElementById("22").style.display = 'none';
                    document.getElementById("33").style.display = 'none';
                    break;
                case 3:
                    document.getElementById("11").style.display = 'none';
                    document.getElementById("22").style.display = 'inline';
                    document.getElementById("33").style.display = 'none';
                    break;
                default:
                    document.getElementById("11").style.display = 'none';
                    document.getElementById("22").style.display = 'none';
                    document.getElementById("33").style.display = 'inline';
                    break;
            }
        }

        function switchSrc(indx, src, audioSource) {
            const modelViewer = document.querySelector('#toggle-model');

            // Play audio
            playAudio(audioSource);

            // Set new model source
            modelViewer.setAttribute('src', src);

            // Display appropriate buttons
            handleButtonDisplay(indx);

            // Play the animation when the model is loaded
            modelViewer.addEventListener('load', function () {
                modelViewer.play();
                playToEnd();
            });
        }

        function playToEnd() {
            const modelViewer = document.querySelector('#toggle-model');
            modelViewer.play();
            
            const duration = modelViewer.duration ? modelViewer.duration * 1000 : 10000; // Default to 10 seconds if duration is not defined
            setTimeout(() => {
                modelViewer.pause();
            }, duration);
        }

        function playAudio(newSrc) {
            var audioElement = document.getElementById("audio");
            var sourceElement = document.getElementById("audio-source");

            // Update the source
            sourceElement.src = newSrc;

            // Load the new source
            audioElement.load();

            // Play the audio
            audioElement.play();
        }
    </script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YQL89QFMW8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-YQL89QFMW8');
    </script>

    <script type="module" src="https://unpkg.com/@onirix/ar-engine-sdk@1.8.1/dist/ox-sdk.esm.js"></script>
    <script src="script.js"></script>
</body>

</html>
