<!doctype html>
<html lang="en" dir="ltr">
  <head>
    <title>STERRADâ„¢ 100NX System</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link type="text/css" href="./styles.css" rel="stylesheet" />
    <script src="https://threejs.org/build/three.min.js"></script>
  </head>
  <body>
    <div id="card">
      <audio id="audio">
        <source id="audio-source" src="Intro.mp3" type="audio/mpeg">
      </audio>

      <model-viewer id="toggle-model" src="Steerad.glb" ar ar-modes="webxr scene-viewer quick-look"
        camera-controls shadow-intensity=".25" environment-image="legacy" animation-loop="false">
        <button id="play-button">Play Animation</button>
        <div id="ar-prompt"><img src="ar_hand_prompt.png"></div>
      </model-viewer>
    </div>

    <script>
      const modelViewer = document.querySelector('#toggle-model');
      const playButton = document.querySelector('#play-button');

      function play_to_end() {
        modelViewer.play();
        const duration = modelViewer.duration || 10; // Fallback to 10 if duration is not available
        setTimeout(() => {
          modelViewer.pause();
        }, duration * 1000); // Convert to milliseconds
      }

      playButton.addEventListener('click', () => {
        play_to_end();
      });

      function switchSrc(indx, src, audioSource) {
        playAudio(audioSource);
        modelViewer.setAttribute('src', `${src}`);
        play_to_end();
      }

      function playAudio(newSrc) {
        const audioElement = document.getElementById('audio');
        const sourceElement = document.getElementById('audio-source');
        sourceElement.src = newSrc;
        audioElement.load();
        audioElement.play();
      }
    </script>
  </body>
</html>
